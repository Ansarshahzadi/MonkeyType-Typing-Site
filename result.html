<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Typing Test Result</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
</head>
<body class="bg-light" style="font-family: monospace;">

  <!-- Navbar -->
  <nav class="navbar navbar-expand-lg bg-white shadow-sm sticky-top">
    <div class="container-fluid px-4">
      <a href="#" class="navbar-brand fw-bold fs-3">
        <span class="text-dark">Typing<span style="color: rgb(234,88,12)">Board</span></span>
      </a>
      <a href="index.html" class="btn btn-primary rounded-pill fw-bold px-3">üè† Home</a>
    </div>
  </nav>

  <!-- Results Summary -->
  <div class="container mt-5">
    <div class="card p-4 shadow rounded-4">
      <h2 class="text-center mb-4">üìä Your Typing Results</h2>
      <div class="row text-center">
        <div class="col-md-3">
          <h4 class="fw-bold text-primary">WPM</h4>
          <p id="wpm" class="fs-4">0</p>
        </div>
        <div class="col-md-3">
          <h4 class="fw-bold text-success">Accuracy</h4>
          <p id="accuracy" class="fs-4">0%</p>
        </div>
        <div class="col-md-3">
          <h4 class="fw-bold text-danger">Errors</h4>
          <p id="errors" class="fs-4">0</p>
        </div>
        <div class="col-md-3">
          <h4 class="fw-bold text-warning">Time</h4>
          <p id="time" class="fs-4">0:00</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Performance Chart -->
  <div class="container mt-5">
    <div class="card p-4 shadow rounded-4">
      <h3 class="text-center mb-4">Performance Analysis</h3>
      <canvas id="performanceChart" height="150"></canvas>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <script>
    // ‚úÖ Load result from localStorage
    let result = JSON.parse(localStorage.getItem("typingResult"));

    if (result) {
      document.getElementById("wpm").innerText = result.wpm;
      document.getElementById("accuracy").innerText = result.accuracy + "%";
      document.getElementById("errors").innerText = result.incorrect;
      document.getElementById("time").innerText = result.time;
    }

    // ‚úÖ Dummy character-wise data (replace later with real test stats)
    let characters = ["A", "B", "C", "D", "E", "F"];
    let wpmData = [60, 48, 70, 55, 65, 50];       // Speed per character
    let accuracyData = [95, 80, 98, 85, 92, 78];  // Accuracy %
    let errors = [1, 6, 0, 4, 2, 7];              // Errors per character

    // ‚úÖ Chart.js mixed chart
    new Chart(document.getElementById("performanceChart"), {
      type: "bar",
      data: {
        labels: characters,
        datasets: [
          {
            type: "line",
            label: "WPM",
            data: wpmData,
            borderColor: "rgb(234,88,12)",
            backgroundColor: "rgba(234,88,12,0.2)",
            yAxisID: "y",
            tension: 0.3
          },
          {
            type: "bar",
            label: "Accuracy (%)",
            data: accuracyData,
            backgroundColor: "rgba(54,162,235,0.6)",
            borderColor: "rgb(54,162,235)",
            yAxisID: "y1"
          }
        ]
      },
      options: {
        responsive: true,
        plugins: {
          tooltip: {
            callbacks: {
              afterBody: function(context) {
                let index = context[0].dataIndex;
                return "Errors: " + errors[index];
              }
            }
          }
        },
        scales: {
          y: {
            beginAtZero: true,
            position: "left",
            title: { display: true, text: "WPM" }
          },
          y1: {
            beginAtZero: true,
            position: "right",
            title: { display: true, text: "Accuracy (%)" },
            grid: { drawOnChartArea: false }
          }
        }
      }
    });
  </script>
</body>
</html>
